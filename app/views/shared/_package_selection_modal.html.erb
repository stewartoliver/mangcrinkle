<!-- Package Selection Modal -->
<div id="packageModal" class="fixed inset-0 hidden z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <!-- Backdrop with blur only -->
  <div class="fixed inset-0 backdrop-blur-sm" data-action="package-modal#close"></div>
  
  <div class="fixed inset-0 z-10 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4">
      <div class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all w-full max-w-md sm:p-6">
        <div class="absolute right-0 top-0 hidden pr-4 pt-4 sm:block">
          <button type="button" data-action="package-modal#close" class="rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2">
            <span class="sr-only">Close</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <div class="sm:flex sm:items-start">
          <div class="mt-3 text-center sm:mt-0 sm:text-left w-full">
            <h3 class="text-2xl font-semibold leading-6 text-orange-950" id="modal-title">Select Your Package Items</h3>
            <div class="mt-4">
              <p class="text-sm text-orange-700">Choose the quantity for each product in your package. Total items must not exceed the package limit.</p>
            </div>
          </div>
        </div>

        <%= form_with url: add_package_cart_path, method: :post, id: "packageForm", data: { turbo: false } do |f| %>
          <%= f.hidden_field :package_id, id: "packageId" %>
          
          <div class="mt-6 space-y-3" id="productSelectionContainer">
            <!-- Product selection fields will be dynamically added here -->
          </div>

          <div class="mt-6 flex items-center justify-between">
            <div class="text-sm text-orange-700">
              <span>Total Items: </span>
              <span id="totalItems">0</span>
              <span>/</span>
              <span id="packageLimit">0</span>
            </div>
            <div class="flex space-x-3">
              <button type="button" data-action="package-modal#close" class="inline-flex justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-orange-700 shadow-sm ring-1 ring-inset ring-orange-300 hover:bg-orange-50">
                Cancel
              </button>
              <%= f.submit "Add to Cart", 
                  class: "inline-flex justify-center rounded-md bg-orange-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600",
                  id: "submitButton" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div> 